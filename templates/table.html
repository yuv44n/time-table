<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <title>{{.ClassName}} Time Table</title>
    <link href="https://fonts.googleapis.com/css2?family=Rubik:wght@400;500;700&display=swap" rel="stylesheet">
    <link
      href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.1/dist/css/bootstrap.min.css"
      rel="stylesheet"
      integrity="sha384-4bw+/aepP/YC94hEpVNVgiZdgIC5+VKNBQNGCHeKRQN+PtmoHDEXuppvnDJzQIu9"
      crossorigin="anonymous"
    />
    <script
      src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.1/dist/js/bootstrap.bundle.min.js"
      integrity="sha384-HwwvtgBNo3bZJJLYd8oVXjrBZt8cqVSpeBNS5n7C8IVInixGAoxmnlMuBnhbgrkm"
      crossorigin="anonymous"
    ></script>
    <script
      src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.4.1/html2canvas.min.js"
      integrity="sha512-BNaRQnYJYiPSqHHDb58B0yaPfCu+Wgds8Gp/gU33kqBtgNS4tSPHuGibyoeqMV/TJlSKda6FXzoEyYGjTe+vXA=="
      crossorigin="anonymous"
      referrerpolicy="no-referrer"
    ></script>
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <style>
      body {
        background: #1A1C1F;
        background-image: 
          linear-gradient(to right, #ffffff20 1px, transparent 1px),
          linear-gradient(to bottom, rgba(255, 255, 255, 0.121) 1px, transparent 1px);
        background-size: 40px 40px;
        font-family: "Rubik", sans-serif !important;
        color: #fff;
        margin: 0;
        padding: 0;
      }

      .container {
        display: flex;
        flex-direction: column;
        align-items: center;
      }

      /* Buttons */
      .button-container {
        margin: 20px auto;
        display: flex;
        justify-content: center;
        gap: 20px;
        flex-wrap: wrap;
      }

      .btn {
        border-radius: 12px;
        padding: 10px 18px;
        font-weight: 500;
        box-shadow: 0 4px 10px rgba(0,0,0,0.4);
        transition: all 0.3s ease-in-out;
      }

      .btn:hover {
        transform: translateY(-2px);
        box-shadow: 0 6px 14px rgba(0,0,0,0.5);
      }

      .header-day {
        background: linear-gradient(145deg, #3f434a, #35393e) !important;
        box-shadow: 
          inset 3px 3px 10px #676A6F,
          3px 3px 10px #000000ab !important; 
        font-weight: bold !important;
        color: #CFDDF7 !important;
      }

      .header-time {
        box-shadow: 
          inset 3px 3px 10px #676A6F,
          3px 3px 10px #000000ab !important; 
        background: #3b3f45 !important;
        font-weight: bold !important;
        color: #CFDDF7 !important;
      }

      /* Timetable container */
      .table-responsive {
        padding: 2%;
        max-width: 100%;
        border-radius: 16px;
        overflow-x: auto;
      }

      /* Table styling */
      .table {
        border-collapse: separate;
        border-spacing: 10px;
        background: transparent;
        width: 100%;
        table-layout: fixed;
      }

      .table td {
        border: none;
        border-radius: 12px;
        padding: 12px;
        font-size: clamp(0.6rem, 1.5vw, 0.95rem);
        font-weight: 500;
        text-align: center;
        color: #f1f1f1;
        box-shadow: 0 3px 10px rgba(0,0,0,0.3);
        transition: transform 0.25s ease, box-shadow 0.25s ease;
        vertical-align: middle;
        height: 100%;
      }

      .table td div {
      display: flex;
      align-items: center;
      justify-content: center;
      min-height: 60px;
      padding: 5px;
      word-break: break-word;
      overflow-wrap: anywhere;
      white-space: normal;    
      max-width: 100%;
      text-align: center;
      font-size: clamp(0.55rem, 1.2vw, 0.85rem);  /* auto shrink on small screens */
      line-height: 1.2;
    }


      .table td:hover {
        transform: scale(1.03);
        box-shadow: 0 6px 16px rgba(0,0,0,0.4);
      }

      /* Color themes for subjects */
      .bg-success {
        background: #24272C !important;
        border-radius: 12px;
        box-shadow: 
          inset 6px 6px 8px #1C1E22,
          inset -6px -6px 8px #2C3036 !important;
      }

      .bg-danger {
        background: rgba(0, 198, 92, 0.2) !important;
        backdrop-filter: blur(2px);
        -webkit-backdrop-filter: blur(2px);
        box-shadow: 0 4px 12px rgba(0, 198, 92, 0.25);
      }

      .bg-primary {
        background: rgba(255, 0, 4, 0.2) !important;
        backdrop-filter: blur(2px);
        -webkit-backdrop-filter: blur(2px);
        box-shadow: 0 4px 12px rgba(255, 0, 4, 0.25);
      }

      .bg-warning {
        background: rgba(67, 70, 248, 0.2) !important;
        backdrop-filter: blur(2px);
        -webkit-backdrop-filter: blur(2px);
        box-shadow: 0 4px 12px rgba(67, 70, 248, 0.25);
      }

      .bg-dark { background: #24272c !important; }
      .bg-info { background: linear-gradient(135deg, #00c6ff, #0072ff) !important; }

      /* Footer */
      footer {
        background: #111;
        color: #bbb;
        padding: 15px;
        font-size: 0.85rem;
        border-top: 1px solid #333;
      }
      footer a { color: #4da8ff; text-decoration: none; font-weight: 500; }
      footer a:hover { text-decoration: underline; }

      /* responsive contributors images  */
     footer p img {
      max-width: 90%;      
      height: auto;        
      display: block;      
      margin: 0 auto;      
    }

       /* ultra-small screens  */
      @media (max-width: 400px) {
        footer p img {
          max-width: 100%;   
        }
      }


      @media (max-width: 600px) {
      .table td div {
        font-size: 0.5rem;   
        padding: 3px;
        line-height: 1.1;
        }
      }

      @media (max-width: 400px) {
        .table td div {
          font-size: 0.35rem;
          line-height: 1.05;
        }
      }

            /* for ultra-small screens  */
      @media (max-width: 400px) {
        .table td {
          padding: 6px 4px; 
        }
        .table td div {
          font-size: 0.4rem; 
          word-break: break-word; 
          line-height: 1.05;
        }
      }


      @media print {
        body { margin: 0; padding: 0; font-family: Arial, sans-serif; }
        @page { size: A4 portrait; margin: 0.5in; }
        .table-responsive { width: 100%; max-width: 100%; overflow: visible; }
        .table, .table td { font-size: 11px; padding: 3px; line-height: 1.4; }
        #timetable { margin-bottom: 5px; page-break-before: auto; page-break-after: auto; max-width: 100%; }
        footer { width: 100%; text-align: center; font-size: 8px; margin-top: 10px; padding: 5px 0; line-height: 1; }
        footer .text-warning { display: none; }
        footer img { display: block; margin: 0 auto; width: 200px; height: auto; }
        footer .text-danger { font-size: 10px; line-height: 1.2; margin-bottom: 5px; }
        header { display: none; }
        footer { max-height: 100px; }
      }
    </style>
  </head>

  <body>
    <header style="margin:1rem auto;display:flex;flex-direction:row;justify-content:space-between;align-items:center;width:95vw;">
      <a href="https://github.com/MicrosoftStudentChapter/time-table/issues">
        <img alt="GitHub issues" src="https://img.shields.io/github/issues/MicrosoftStudentChapter/time-table?style=flat&logo=github"/>
      </a>
      <a href="https://github.com/MicrosoftStudentChapter/time-table">
        <img alt="GitHub Repo stars" src="https://img.shields.io/github/stars/MicrosoftStudentChapter/time-table?style=flat&logo=github"/>
      </a>
    </header>

    <div class="button-container">
      <button id="saveAsPng" class="btn btn-primary">Save as PNG</button>
      <button id="printPdf" class="btn btn-success">Print to PDF</button>
    </div>

    <table class="table table-dark table-hover" id="table">
      {{range $rowIndex, $row := .Data}}
      <tr>
        {{range $colIndex, $cell := $row}}
          {{if eq $cell.Color "dark"}}
            {{if eq $rowIndex 0}}
              <td class="header-day"><div>{{$cell.Course}}</div></td>
            {{else if eq $colIndex 0}}
              <td class="header-time"><div>{{$cell.Course}}</div></td>
            {{else}}
              <td class="bg-dark empty"><div>{{$cell.Course}}</div></td>
            {{end}}
          {{else}}
            <td class="bg-{{$cell.Color}}"><div>{{$cell.Course}}</div></td>
          {{end}}
        {{end}}
      </tr>
      {{end}}
    </table>

    <footer class="footer mt-2 mb-2 pb-2 pt-2 bg-dark">
      <p style="text-align: center" class="text-danger">
        Made by Utkarsh Tripathi &nbsp;
        <a href="https://github.com/utkarsh-1905" class="badge badge-success">Github</a>
        <a href="https://www.linkedin.com/in/utkarsh-tripathi-80a0ab192/" class="badge badge-primary">Linkedin</a>
      </p>
      <p style="text-align: center" class="text-warning">Project contributors</p>
      <p style="text-align: center">
        <a href="https://github.com/MicrosoftStudentChapter/time-table/graphs/contributors">
          <img src="https://contrib.rocks/image?repo=MicrosoftStudentChapter/time-table" />
        </a>
      </p>
    </footer>

    <script>
    document.getElementById("saveAsPng").addEventListener("click", function () {
      const timetableElement = document.getElementById("table"); // fixed id
      html2canvas(timetableElement, { backgroundColor: "#000" }) // better visibility
        .then((canvas) => {
          const link = document.createElement("a");
          link.download = "timetable.png";
          link.href = canvas.toDataURL("image/png");
          link.click();
        })
        .catch((error) => {
          console.error("Error saving PNG:", error);
        });
    });

    document.getElementById("printPdf").addEventListener("click", function () {
      const originalContent = document.body.innerHTML;
      const printContent = document.getElementById("table").outerHTML; // fixed id
      const footerContent = document.querySelector("footer").outerHTML;
      document.body.innerHTML = printContent + footerContent;
      window.print();
      document.body.innerHTML = originalContent;
    });
  </script>

  </body>
</html>